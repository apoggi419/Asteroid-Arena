$(document).ready(function(){window.onblur=function(){p=true};var F=document.getElementById("game-music");$("nav").toggle();F.play();var f=document.querySelector(".my-game");f.width=window.innerWidth;f.height=window.innerHeight;var z=f.getContext("2d");var u=null;var p=false;var D=[];var h=false;var k=5;var G=null;var o=["quantum-blast","particle-slow","atomic-shrink","antimatter-cloak","quasar-beam"];var d={height:null,width:null,x:null,y:null};var A={height:null,width:null,x:null,y:null};var m={amount:0,x:f.width*0.95,y:f.height*0.05,draw:function(){z.fillStyle="black";z.font="24px sans-serif";z.fillText(this.amount,this.x,this.y)}};var l={amount:10,x:f.width*0.9,y:f.height*0.9,draw:function(){if(this.amount>7){z.fillStyle="rgba(41, 236, 31, 0.64)"}else{if(this.amount>3){z.fillStyle="rgba(219, 241, 37, 0.63)"}else{z.fillStyle="rgba(244, 16, 16, 0.68)"}}z.fillRect(this.x,this.y,this.amount*10,50)}};var B={x:f.width/2,y:f.height/2,height:30,width:30,speed:3,direction:"",power:null,streak:null,intangible:false,quasarActivated:false,checkStreak:function(){if(m.amount>90){B.streak="god"}else{if(m.amount>60){B.streak="unstoppable"}else{if(m.amount>40){B.streak="on-fire"}else{if(m.amount>20){B.streak="heating-up"}else{B.streak=null}}}}},draw:function(){z.fillStyle="rgb(104, 13, 236)";if(h){switch(this.power){case"quantum-blast":z.fillStyle="rgb(66, 138, 223)";break;case"particle-slow":z.fillStyle="rgb(55, 161, 22)";break;case"atomic-shrink":z.fillStyle="rgb(186, 35, 210)";break;case"antimatter-cloak":z.fillStyle="black";break;case"quasar-beam":z.fillStyle="rgb(164, 0, 0)";break;default:break}}if(B.streak!==null){switch(B.streak){case"heating-up":z.shadowBlur=40;z.shadowColor="rgba(0, 252, 10, 1)";break;case"on-fire":z.shadowBlur=40;z.shadowColor="rgb(6, 248, 255)";break;case"unstoppable":z.shadowBlur=40;z.shadowColor="rgb(255, 0, 0)";break;case"god":z.shadowBlur=40;z.shadowColor="rgb(255, 244, 0)";break}}if(B.intangible){y()}z.fillRect(this.x,this.y,this.width,this.height);z.shadowBlur=0}};s();requestAnimationFrame(t);function t(){z.clearRect(0,0,f.width,f.height);if(B.quasarActivated){q()}B.checkStreak();B.draw();j();r();e();m.draw();l.draw();if(!p){requestAnimationFrame(t)}if(p){F.pause();v("game-over");v("final-time");v("try-again");$("nav").fadeToggle();$("canvas").css("cursor","default")}}$(document).keydown(function(H){H.preventDefault();switch(H.keyCode){case 82:if(p){location.reload()}break;case 65:case 37:B.direction="left";break;case 87:case 38:B.direction="up";break;case 68:case 39:B.direction="right";break;case 83:case 40:B.direction="down";break;case 69:case 32:if(h){switch(B.power){case"quantum-blast":D.forEach(function(J,I){if(Math.abs(B.x-J.x)<w(B.width*40,B.width*15)&&Math.abs(B.y-J.y)<w(B.height*40,B.height*15)&&J.type=="asteroid"){D.splice(I,1)}});document.getElementById("quantum-blast-sound").play();break;case"particle-slow":D.forEach(function(I){if(I.type==="asteroid"){I.speed*=0.24}});document.getElementById("particle-slow-sound").play();break;case"atomic-shrink":D.forEach(function(J,I){if(J.type==="asteroid"){J.height*=0.4;J.width*=0.4;if(J.height<7||J.width<7){D.splice(I,1)}}});document.getElementById("atomic-shrink-sound").play();break;case"antimatter-cloak":u=m.amount+k;B.intangible=true;document.getElementById("antimatter-cloak-sound").play();break;case"quasar-beam":G=m.amount+2;B.quasarActivated=true;document.getElementById("quasar-beam-sound").play();break}h=false;B.power=null}break}});function q(){if(G>m.amount){d.height=f.height;d.width=B.width;d.x=B.x;d.y=0;A.height=B.height;A.width=f.width;A.x=0;A.y=B.y;z.shadowBlur=40;z.shadowColor="rgb(164, 0, 0)";z.fillStyle="rgb(164, 0, 0)";z.fillRect(d.x,d.y,d.width,d.height);z.fillRect(A.x,A.y,A.width,A.height);z.shadowBlur=0}else{G=null;B.quasarActivated=false;d.height=null;d.width=null;d.x=null;d.y=null;A.height=null;A.width=null;A.x=null;A.y=null}}function r(){if(B.intangible&&m.amount>u){B.intangible=false;u=null}}function y(){z.fillStyle="rgba(104, 13, 236, 0.30)"}function e(){D.forEach(function(I,H){I.draw();x(I);if(b(I)){D.splice(H,1)}if(I.crashWith(B)){if(B.intangible&&I.type==="asteroid"){D.splice(H,1)}if(I.type==="asteroid"&&!B.intangible){p=true;document.getElementById("game-over-sound").play()}else{if(I.type==="fuel"){if(l.amount<10){l.amount++}D.splice(H,1)}else{if(I.type==="power-up"){h=true;B.power=I.powerType;D.splice(H,1)}}}}if(B.quasarActivated&&I.type!=="power-up"&&(I.crashWith(d)||I.crashWith(A))){D.splice(H,1)}})}function j(){if(l.amount>0){x(B)}if(l.amount<3&&l.amount>0){v("low-fuel")}if(l.amount===0){v("no-fuel")}}function s(){var H=0;var I=setInterval(function(){if(!p){H++;if(H%10===0){g("power-up")}if(H%12===0){if(l.amount>0){l.amount--}}if(H%4===0){g("fuel");m.amount++}for(var J=m.amount;J>0;J-=10){if(H%12===0){g("asteroid")}if(H%120===0){g("power-up")}if(H%48===0){g("fuel")}}g("asteroid")}else{clearInterval(I)}},250)}function g(I){var H=new c(I);H.spawn();D.push(H)}function c(H){this.type=H;this.height=E(H);this.width=E(H);this.speed=this.generateSpeed();this.powerType=this.generatePowerType()}c.prototype.generatePowerType=function(){if(this.type!=="asteroid"){var H=Math.floor(w(o.length,0));if(H===o.length){H--}return o[H]}else{return null}};c.prototype.draw=function(){switch(this.type){case"asteroid":z.fillStyle="rgb(121, 121, 122)";break;case"fuel":z.fillStyle="rgb(231, 163, 31)";break;case"power-up":switch(this.powerType){case"quantum-blast":z.fillStyle="rgb(66, 138, 223)";break;case"particle-slow":z.fillStyle="rgb(55, 161, 22)";break;case"atomic-shrink":z.fillStyle="rgb(186, 35, 210)";break;case"antimatter-cloak":z.fillStyle="black";break;case"quasar-beam":z.fillStyle="rgb(164, 0, 0)";break}break}z.fillRect(this.x,this.y,this.width,this.height)};c.prototype.spawn=function(){var H=Math.floor(w(4,0));switch(H){case 0:this.x=w(f.width,0);this.y=0;this.direction="down";break;case 1:this.x=f.width;this.y=w(f.height,0);this.direction="left";break;case 2:this.x=w(f.width,0);this.y=f.height;this.direction="up";break;case 3:this.x=0;this.y=w(f.height,0);this.direction="right";break;case 4:this.x=0;this.y=w(f.height,0);this.direction="right";break}};c.prototype.crashWith=function(H){return i(this)>=a(H)&&a(this)<=i(H)&&n(this)>=C(H)&&C(this)<=n(H)};c.prototype.generateSpeed=function(){var I=2;var H=0.2;var J=w(I,H);if(this.type==="power-up"){return J*1.25}else{return J}};function a(H){return H.y}function i(H){return H.y+H.height}function C(H){return H.x}function n(H){return H.x+H.width}function x(H){switch(H.direction){case"left":if(H.x>=0){H.x-=H.speed}break;case"down":if(H.y<=f.height){H.y+=H.speed}break;case"up":if(H.y>=0){H.y-=H.speed}break;case"right":if(H.x<=f.width){H.x+=H.speed}break;default:break}}function E(H){var J;var I;if(H==="asteroid"){J=50;I=20;return w(J,I)}else{return 10}}function w(H,I){return Math.random()*(H-I)+I}function b(H){if(H.x>f.width||H.y>f.height||H.x<0||H.y<0){return true}else{return false}}function v(I){var J=[{name:"game-over",fillStyle:"black",fillText:"Game Over",x:f.width/2,y:f.height/4},{name:"low-fuel",fillStyle:"rgb(251, 17, 10)",fillText:"Warning: Low Fuel!",x:f.width/2,y:f.height/6},{name:"no-fuel",fillStyle:"rgb(251, 17, 10)",fillText:"Out of Fuel",x:f.width/2,y:f.height/6},{name:"try-again",fillStyle:"black",fillText:"Press R to try again.",x:f.width/2,y:f.height/2},{name:"final-time",fillStyle:"black",fillText:"You lasted "+m.amount+" seconds in the arena!",x:f.width/2,y:f.height/2.5}];var H;J.forEach(function(K){if(I===K.name){H=K}});z.fillStyle=H.fillStyle;if(H.name==="game-over"){z.font="48px sans-serif"}else{z.font="24px sans-serif"}z.fillStyle=H.fillStyle;z.textAlign="center";z.fillText(H.fillText,H.x,H.y)}});