$(document).ready(function(){var u=false;if(window.location.href.indexOf("classic")>-1){u=true}window.onblur=function(){q=true};var G=document.getElementById("game-music");$("nav").toggle();G.play();var f=document.querySelector(".my-game");f.width=window.innerWidth;f.height=window.innerHeight;var A=f.getContext("2d");var v=null;var q=false;var E=[];var h=false;var k=5;var H=null;var p=["quantum-blast","particle-slow","atomic-shrink","antimatter-cloak","quasar-beam"];var d={height:null,width:null,x:null,y:null};var B={height:null,width:null,x:null,y:null};var m={amount:0,x:f.width*0.95,y:f.height*0.05,draw:function(){A.fillStyle="black";A.font="24px sans-serif";A.fillText(this.amount,this.x,this.y)}};var l={amount:10,x:f.width*0.9,y:f.height*0.9,draw:function(){if(this.amount>7){A.fillStyle="rgba(41, 236, 31, 0.64)"}else{if(this.amount>3){A.fillStyle="rgba(219, 241, 37, 0.63)"}else{A.fillStyle="rgba(244, 16, 16, 0.68)"}}A.fillRect(this.x,this.y,this.amount*10,50)}};var C={x:f.width/2,y:f.height/2,height:30,width:30,speed:3,direction:"",power:null,streak:null,intangible:false,quasarActivated:false,checkStreak:function(){if(m.amount>90){C.streak="god"}else{if(m.amount>60){C.streak="unstoppable"}else{if(m.amount>40){C.streak="on-fire"}else{if(m.amount>20){C.streak="heating-up"}else{C.streak=null}}}}},draw:function(){A.fillStyle="rgb(104, 13, 236)";if(h){switch(this.power){case"quantum-blast":A.fillStyle="rgb(66, 138, 223)";break;case"particle-slow":A.fillStyle="rgb(55, 161, 22)";break;case"atomic-shrink":A.fillStyle="rgb(186, 35, 210)";break;case"antimatter-cloak":A.fillStyle="black";break;case"quasar-beam":A.fillStyle="rgb(164, 0, 0)";break;default:break}}if(C.streak!==null){switch(C.streak){case"heating-up":A.shadowBlur=40;A.shadowColor="rgba(0, 252, 10, 1)";break;case"on-fire":A.shadowBlur=40;A.shadowColor="rgb(6, 248, 255)";break;case"unstoppable":A.shadowBlur=40;A.shadowColor="rgb(255, 0, 0)";break;case"god":A.shadowBlur=40;A.shadowColor="rgb(255, 244, 0)";break}}if(C.intangible){z()}A.fillRect(this.x,this.y,this.width,this.height);A.shadowBlur=0}};s();requestAnimationFrame(t);function t(){A.clearRect(0,0,f.width,f.height);if(C.quasarActivated){o()}C.checkStreak();C.draw();j();r();e();m.draw();if(!u){l.draw()}if(!q){requestAnimationFrame(t)}if(q){G.pause();w("game-over");w("final-time");w("try-again");$("nav").fadeToggle();$("canvas").css("cursor","default")}}$(document).keydown(function(I){I.preventDefault();switch(I.keyCode){case 82:if(q){location.reload()}break;case 65:case 37:C.direction="left";break;case 87:case 38:C.direction="up";break;case 68:case 39:C.direction="right";break;case 83:case 40:C.direction="down";break;case 69:case 32:if(h){switch(C.power){case"quantum-blast":E.forEach(function(K,J){if(Math.abs(C.x-K.x)<x(C.width*40,C.width*15)&&Math.abs(C.y-K.y)<x(C.height*40,C.height*15)&&K.type=="asteroid"){E.splice(J,1)}});document.getElementById("quantum-blast-sound").play();break;case"particle-slow":E.forEach(function(J){if(J.type==="asteroid"){J.speed*=0.24}});document.getElementById("particle-slow-sound").play();break;case"atomic-shrink":E.forEach(function(K,J){if(K.type==="asteroid"){K.height*=0.4;K.width*=0.4;if(K.height<7||K.width<7){E.splice(J,1)}}});document.getElementById("atomic-shrink-sound").play();break;case"antimatter-cloak":v=m.amount+k;C.intangible=true;document.getElementById("antimatter-cloak-sound").play();break;case"quasar-beam":H=m.amount+2;C.quasarActivated=true;document.getElementById("quasar-beam-sound").play();break}h=false;C.power=null}break}});function o(){if(H>m.amount){d.height=f.height;d.width=C.width;d.x=C.x;d.y=0;B.height=C.height;B.width=f.width;B.x=0;B.y=C.y;A.shadowBlur=40;A.shadowColor="rgb(164, 0, 0)";A.fillStyle="rgb(164, 0, 0)";A.fillRect(d.x,d.y,d.width,d.height);A.fillRect(B.x,B.y,B.width,B.height);A.shadowBlur=0}else{H=null;C.quasarActivated=false;d.height=null;d.width=null;d.x=null;d.y=null;B.height=null;B.width=null;B.x=null;B.y=null}}function r(){if(C.intangible&&m.amount>v){C.intangible=false;v=null}}function z(){A.fillStyle="rgba(104, 13, 236, 0.30)"}function e(){E.forEach(function(J,I){J.draw();y(J);if(b(J)){E.splice(I,1)}if(J.crashWith(C)){if(C.intangible&&J.type==="asteroid"){E.splice(I,1)}if(J.type==="asteroid"&&!C.intangible){q=true;document.getElementById("game-over-sound").play()}else{if(J.type==="fuel"){if(l.amount<10){l.amount++}E.splice(I,1)}else{if(J.type==="power-up"){h=true;C.power=J.powerType;E.splice(I,1)}}}}if(C.quasarActivated&&J.type!=="power-up"&&(J.crashWith(d)||J.crashWith(B))){E.splice(I,1)}})}function j(){if(l.amount>0){y(C)}if(l.amount<3&&l.amount>0){w("low-fuel")}if(l.amount===0){w("no-fuel")}}function s(){var I=0;var J=setInterval(function(){if(!q){I++;if(I%10===0&&!u){g("power-up")}if(I%12===0&&!u){if(l.amount>0){l.amount--}}if(I%4===0){if(!u){g("fuel")}m.amount++}for(var K=m.amount;K>0;K-=10){if(I%12===0){g("asteroid")}if(I%120===0&&!u){g("power-up")}if(I%48===0&&!u){g("fuel")}}g("asteroid")}else{clearInterval(J)}},250)}function g(J){var I=new c(J);I.spawn();E.push(I)}function c(I){this.type=I;this.height=F(I);this.width=F(I);this.speed=this.generateSpeed();this.powerType=this.generatePowerType()}c.prototype.generatePowerType=function(){if(this.type!=="asteroid"){var I=Math.floor(x(p.length,0));if(I===p.length){I--}return p[I]}else{return null}};c.prototype.draw=function(){switch(this.type){case"asteroid":A.fillStyle="rgb(121, 121, 122)";break;case"fuel":A.fillStyle="rgb(231, 163, 31)";break;case"power-up":switch(this.powerType){case"quantum-blast":A.fillStyle="rgb(66, 138, 223)";break;case"particle-slow":A.fillStyle="rgb(55, 161, 22)";break;case"atomic-shrink":A.fillStyle="rgb(186, 35, 210)";break;case"antimatter-cloak":A.fillStyle="black";break;case"quasar-beam":A.fillStyle="rgb(164, 0, 0)";break}break}A.fillRect(this.x,this.y,this.width,this.height)};c.prototype.spawn=function(){var I=Math.floor(x(4,0));switch(I){case 0:this.x=x(f.width,0);this.y=0;this.direction="down";break;case 1:this.x=f.width;this.y=x(f.height,0);this.direction="left";break;case 2:this.x=x(f.width,0);this.y=f.height;this.direction="up";break;case 3:this.x=0;this.y=x(f.height,0);this.direction="right";break;case 4:this.x=0;this.y=x(f.height,0);this.direction="right";break}};c.prototype.crashWith=function(I){return i(this)>=a(I)&&a(this)<=i(I)&&n(this)>=D(I)&&D(this)<=n(I)};c.prototype.generateSpeed=function(){var J=2;var I=0.2;var K=x(J,I);if(this.type==="power-up"){return K*1.25}else{return K}};function a(I){return I.y}function i(I){return I.y+I.height}function D(I){return I.x}function n(I){return I.x+I.width}function y(I){switch(I.direction){case"left":if(I.x>=0){I.x-=I.speed}break;case"down":if(I.y<=f.height){I.y+=I.speed}break;case"up":if(I.y>=0){I.y-=I.speed}break;case"right":if(I.x<=f.width){I.x+=I.speed}break;default:break}}function F(I){var K;var J;if(I==="asteroid"){K=50;J=20;return x(K,J)}else{return 10}}function x(I,J){return Math.random()*(I-J)+J}function b(I){if(I.x>f.width||I.y>f.height||I.x<0||I.y<0){return true}else{return false}}function w(J){var K=[{name:"game-over",fillStyle:"black",fillText:"Game Over",x:f.width/2,y:f.height/4},{name:"low-fuel",fillStyle:"rgb(251, 17, 10)",fillText:"Warning: Low Fuel!",x:f.width/2,y:f.height/6},{name:"no-fuel",fillStyle:"rgb(251, 17, 10)",fillText:"Out of Fuel",x:f.width/2,y:f.height/6},{name:"try-again",fillStyle:"black",fillText:"Press R to try again.",x:f.width/2,y:f.height/2},{name:"final-time",fillStyle:"black",fillText:"You lasted "+m.amount+" seconds in the arena!",x:f.width/2,y:f.height/2.5}];var I;K.forEach(function(L){if(J===L.name){I=L}});A.fillStyle=I.fillStyle;if(I.name==="game-over"){A.font="48px sans-serif"}else{A.font="24px sans-serif"}A.fillStyle=I.fillStyle;A.textAlign="center";A.fillText(I.fillText,I.x,I.y)}});